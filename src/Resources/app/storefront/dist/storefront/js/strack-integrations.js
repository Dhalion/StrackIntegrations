"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["strack-integrations"],{4521:(t,e,i)=>{var r=i(9068),n=i(6285),s=i(3206),o=i(8254),a=i(4690);class c extends n.Z{init(){this.quantityInput=s.Z.querySelector(this.el.parentNode,"[data-quantity-selector] input",!1),this.quantityInput&&(this.productId=this.el.getAttribute("data-product-id"),this.customerPriceEndpoint=this.el.getAttribute("data-customer-price-endpoint"),this.isComponent="1"===this.el.getAttribute("data-is-component"),this.buyWidgetPriceContainer=s.Z.querySelector(document,".product-detail-price-container"),this.client=new o.Z(window.accessKey,window.contextToken),this.registerEventListeners())}registerEventListeners(){this.quantityInput.addEventListener("change",this.onQuantityChange.bind(this))}onQuantityChange(){this.createLoadingIndicator(),this.client.post(this.customerPriceEndpoint,JSON.stringify({productId:this.productId,quantity:this.quantityInput.value,isComponent:this.isComponent}),(t=>{this.replaceCustomerPrice(t),this.removeLoadingIndicator()}))}replaceCustomerPrice(t){this.buyWidgetPriceContainer.innerHTML=t}createLoadingIndicator(){a.Z.create(this.el.parentNode)}removeLoadingIndicator(){a.Z.remove(this.el.parentNode)}}class d extends n.Z{init(){this._apiRoute="/strack-integrations/export-cart",this._client=new o.Z,this._registerEvents()}_registerEvents(){this.el.addEventListener("click",this._onClick.bind(this))}_onClick(t){t.preventDefault(),console.log("Cart Export Clicked"),this._fetch()}_fetch(){const t=this.el.getAttribute("data-strack-cart-export-type"),e=`${this._apiRoute}?type=${t}`;this.request_start=new Date,fetch(e).then((t=>{if(!t.ok)throw new Error(`HTTP error! Status: ${t.status}`);return t.blob()})).then((e=>{const i=new Date-this.request_start;console.log(`Took ${i}ms to get response with status 200`),this._downloadFile(e,t)})).catch((t=>{console.error(`Error: ${t.message}`)}))}_downloadFile(t,e){const i=`cart.${"csv"===e?"csv":"xlsx"}`,r=document.createElement("a");r.href=window.URL.createObjectURL(t),r.setAttribute("download",i),r.setAttribute("target","_blank"),r.click(),URL.revokeObjectURL(r.href)}}r.Z.register("QuantitySelectorCustomerPrice",c,"[data-quantity-selector-customer-price]"),r.Z.register("CartExporter",d,"[data-strack-cart-export-button]")}},t=>{t.O(0,["vendor-node","vendor-shared"],(()=>{return e=4521,t(t.s=e);var e}));t.O()}]);